[{
    "regex": "(?i)((p((a|@)(s|\\$)(s|\\$)?(w(o|0)rd(s|\\$)?)?|wr?d?|(a|@)(s|\\$)(s|\\$)?wd)|(p(((s|\\$)(s|\\$)?(w(o|0)?r?d(s|\\$)?)?)|rd))))\\s*=\\s*\".*\"\\s*;",
    "label": "Passwords",
    "description": "Passwords should not be written in the source code, since they can be read by code decompilers.",
    "criticity": "critical",
    "whitelist": ["(\\W|_|^)p\\$\\$?(\\W|_|$)", "(\\W|_|^)ps(\\W|_|$)", "(\\W|_|^)pw(\\W|_|$)", "(\\W|_|^)prd(\\W|_|$)", "(\\W|_|^)pwr(\\W|_|$)", "(\\W|_|^)pss(\\W|_|$)", "(\\W|_|^)p\\$(\\W|_|$)"]
}, {
    "regex": "(?:(?:(?:ftp|http)s?:)?\/\/)[\\w\\.-]+\\.[a-zA-Z]{2,6}(?:\/[\\w\\.\/-]*)?",
    "whitelist": [
        "schemas.android.com/apk",
        "www.w3.org/2005/Atom",
        "www.apache.org/licenses"
    ],
    "label": "URL Disclosure",
    "description": "The decompilation of the source code could lead to the disclosure of private URLs.",
    "criticity": "warning"
}, {
    "regex": "catch\\s*\\(\\s*(?:(?:\\s*\\|?\\s*\\w+)*\\s*\\|)?\\s*Exception\\s*(?:(?:\\s*\\|\\s*\\w+)*)?\\s+\\w+\\s*\\)",
    "criticity": "low",
    "label": "Generic Exception in catch",
    "description": "Exception catching should be specific. Generic Exception type could not be safe and lead to silent error suppresion"
}, {
    "regex": "throws\\s+(?:\\w*\\s*,\\s*)*Exception\\s*[,{]",
    "criticity": "low",
    "label": "Generic Exception in Throws",
    "description": "The exceptions thrown by a method should be specific. Generic Exception type could could not be safe and lead to silent error suppresion."
}, {
    "regex": "(?:setVisible\\s*\\(\\s*View\\s*\\.\\s*(?:INVISIBLE|invisible)\\s*\\))|(?:android:visibility\\s*=\\s*\"invisible\")|(?:android:background\\s*=\\s*\"(?i)(?:@?null)\")",
    "criticity": "low",
    "label": "Hidden fields",
    "description": "Hidden fields are often used to cover data from the user, but they are discouraged, since they can lead to data disclosire."
}, {
    "regex": "catch\\s*\\((?:\\w|\\s|\\|)+\\)\\s*\\{\\s*\\}",
    "criticity": "low",
    "label": "Empty catch",
    "description": "Empty catches can lead to silent error suppresion, which could make the application unstable and even lead to security vulnerabilities."
}, {
    "regex": "[^0-9a-zA-Z\\n.](?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",
    "criticity": "high",
    "label": "IP Disclosure",
    "description": "The decompilation of the source code could lead to the disclosure of private IPs."
}, {
    "regex": "([:^xdigit:]|^)([:xdigit:]{1,4}:){7,7}[:xdigit:]{1,4}|([:xdigit:]{1,4}:){1,7}:|([:xdigit:]{1,4}:){1,6}:[:xdigit:]{1,4}|([:xdigit:]{1,4}:){1,5}(:[:xdigit:]{1,4}){1,2}|([:xdigit:]{1,4}:){1,4}(:[:xdigit:]{1,4}){1,3}|([:xdigit:]{1,4}:){1,3}(:[:xdigit:]{1,4}){1,4}|([:xdigit:]{1,4}:){1,2}(:[:xdigit:]{1,4}){1,5}|[:xdigit:]{1,4}:((:[:xdigit:]{1,4}){1,6})|:((:[:xdigit:]{1,4}){1,7}|:)|fe80:(:[:xdigit:]{0,4}){0,4}%[:xdigit:]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]).){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([:xdigit:]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]).){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])([:^xdigit:]|$)",
    "label": "IP Disclosure",
    "description": "The decompilation of the source code could lead to the disclosure of private IPs.",
    "criticity": "warning",
    "whitelist": ["[:^xdigit:]::[:^xdigit:]"]
},{
    "regex": "Math\\s*\\.\\s*random\\s*\\(\\s*\\)",
    "criticity": "high",
    "label": "Math Random method",
    "description": "This method is not as random as it is supossed to be. It should not be use to generate OTP codes."
}, {
    "regex": "Log\\s*\\.\\s*(?:w(?:tf)?|e|d|i|v)+\\s*\\((?:\\s*\"?(?:[A-Za-z0-9])*(?:.)*\"?\\s*),(?:\\s*\"(?:[A-Za-z0-9])*(?:.)*\"\\s*\\+)?\\s*(?:[A-Za-z0-9.\\(\\)\\[\\]-])*(?:_(?:[A-Za-z0-9.\\(\\)\\[\\]-])*)*\\s*(?:(?:\\+\\s*(?:[A-Za-z0-9.\\(\\)\\[\\]-])*(?:_(?:[A-Za-z0-9.\\(\\)\\[\\]-])*)*\\s*)*)?\\)\\s*;",
    "criticity": "low",
    "label": "Unchecked output in Logs",
    "description": "Sensitive information should never be logged since it can lead to that information being disclosed."
}, {
    "regex": "(([:alpha:]:)?\\[^0 !\\$`&\\*\\(\\)\\+]\\w.+)|([:alpha:]:\\\\)",
    "label": "Hardcoded file separator",
    "description": "Paths like C:\\Program Files\\... can cause problems, and are considered vulnerabilities, since some OSs use backslashes `\\` (DOS/Windows) and others slashes `/` (Unix).",
    "criticity": "high"
}, {
    "regex": "=(?:\\s*)\"(?:\\s*)\/(?:(?:\\s*)[^\\0\/ !$&(?:)+](?:.+)?\\s*)?\"",
    "criticity": "high",
    "label": "Hardcoded file separator Unix",
    "description": "Paths like C:\\\\Program Files\\\\... can cause problems, and are considered vulnerabilities, since some OSs use backslashes `\\\\` (DOS\/Windows) and others slashes `\/` (Unix)."
}, {
    "regex": "(?:DESKeySpec)|(?:getInstance\\(\\s*\"?\\s*(?:md5|MD5)\\s*\"?\\s*\\))|(?:getInstance\\(\\s*\"?\\s*(?:sha-1|SHA-1)\\s*\"?\\s*\\))",
    "criticity": "low",
    "label": "Weak Algorithms",
    "description": "Using weak algorithms allows an attacker to break the cyphered communications gaining access to plain text content."
}, {
    "regex": "(?:Thread|thread|SystemClock)\\s*\\.\\s*sleep\\s*\\(\\s*(?:(?:\\d+(?:\\s*\\+\\s*\\d*\\s*)*\\s*\\+\\s*[A-za-z]+(?:(?:\\s*\\+\\s*(?:\\d|[A-za-z])*)*)?)|(?:[A-za-z]+\\s*(?:\\+\\s*(?:\\d|[A-za-z])*(?:\\s*\\+\\s*(?:\\d|[A-za-z])*)*)?))\\s*\\)\\s*;",
    "criticity": "high",
    "label": "Sleep Method",
    "description": "Sleep Method is used with vars as arguments. If that vars are modifeid it could force the aplication to stop indefinetly."
}, {
    "regex": "(?:(?:Context\\.)?MODE_WORLD_READABLE)|(?:openFileOutput\\(\\s*\"?.+\"?\\s*,\\s*1\\s*\\))",
    "criticity": "high",
    "label": "world readable permissions",
    "description": "Setting world readable permissions allows to anyone (with access to the target file) to read file content."
}, {
    "regex": "(?:(?:Context\\.)?MODE_WORLD_WRITABLE)|(?:openFileOutput\\(\\s*\"?.+\"?\\s*,\\s*2\\s*\\))",
    "criticity": "high",
    "label": "world writable permissions",
    "description": "Setting world writable permissions allows to anyone (with access to the target file) to modify file content."
}, {
    "regex": "(?:[a-zA-Z]:|\\\\)\\\\((?:\\s*)[^\\0 !$`&*(?:)+]\\w.+)?",
    "criticity": "medium",
    "label": "Hardcoded file separator Windows",
    "description": "Paths like C:\\Program Files\\... can cause problems, and are considered vulnerabilities, since some OSs use backslashes `\\` (DOS\\\/Windows) and others slashes `\/` (Unix)."
}, {
    "regex": "\\.getExternal(?:Storage|FilesDir)(?:\\(.*\\))?",
    "permissions": [
        "android.permission.WRITE_EXTERNAL_STORAGE"
    ],
    "criticity": "high",
    "label": "Write-Read in external storage",
    "description": "Application can read\/write in external storage. Any app can read data written in external storage."
}, {
    "regex": "\\.createTempFile\\(.*\\)",
    "permissions": [
        "android.permission.WRITE_EXTERNAL_STORAGE"
    ],
    "criticity": "high",
    "label": "Temp File Use",
    "description": "Applications is creating temp files. Sensitive information should never be written in temp files."
}, {
    "regex": "setJavaScriptEnabled\\(true\\)",
    "forward_check": "\\.addJavascriptInterface\\(.*\\)",
    "criticity": "critical",
    "label": "Web View XSS",
    "description": "Web view insecure implementation. This issue could allow to a remote attacker to code execution in Web View and performing Cross Site Scripting attacks."
}, {
    "regex": "onReceivedSslError\\s*\\(\\s*WebView\\s*.*\\)",
    "forward_check": "\\.\\s*proceed\\(\\s*\\)\\s*;",
    "criticity": "critical",
    "label": "Web View ignores ssl errors",
    "description": "Web View is ignoring SSL errors and it accepts any SSL certificate. This application could be affected by Man in the Middle attacks."
}, {
    "regex": "android\\.database\\.sqlite",
    "forward_check": "rawQuery\\(.*\\)|execSQL\\(.*\\)",
    "criticity": "critical",
    "label": "SQL injection",
    "description": "This application is vulnerable to SQL injection. Any data stored in database can be exposed as any attacker is able to retrive, modify and delete the stored information."
}, {
    "regex": "javax.net.ssl",
    "forward_check": "(?:(?:Trust)?All(?:Trust)?SSLSocket(?:-)?Factory|NonValidatingSSLSocketFactory|ALLOW_ALL_HOSTNAME_VERIFIER|\\.setDefaultHostnameVerifier\\(.*\\)|NullHostnameVerifier\\(.*\\))",
    "criticity": "critical",
    "label": "Accepting all SSL certificates",
    "description": "Insecure application SSL implementation. This application accepts all certificates, including self signed by default. This is a critical issue as Man in the Middle attacks may be performed."
}, {
    "regex": "telephony.SmsManager",
    "forward_check": "send(?:Multipart)?TextMessage|vnd\\.android-dir\/mms-sms",
    "criticity": "warning",
    "label": "Sending sms-mms",
    "description": "This application is sending sms or mms and it might be without the user's knowledge "
}, {
    "regex": "com\\.noshufou\\.android\\.su|com\\.thirdparty\\.superuser|eu\\.chainfire\\.supersu|com\\.koushikdutta\\.superuser|eu\\.chainfire\\.",
    "criticity": "warning",
    "label": "Super user privileges.",
    "description": "This applications may require super user privileges."
}, {
    "regex": ".contains\\(\"test-keys\"\\)|\/system\/app\/Superuser.apk|isDeviceRooted\\(\\)|\/system\/bin\/failsafe\/su|\/system\/sd\/xbin\/su|RootTools.isAccessGiven\\(\\)",
    "criticity": "high",
    "label": "Rooted device detection",
    "description": "This applications is performing checks for rooted device. This could be use to execute specific code if the device is rooted to take control of it."
}, {
    "regex": "telephony\\.TelephonyManager",
    "forward_check": "getCellLocation",
    "criticity": "warning",
    "label": "Cell Location (Base Stations)",
    "description": "This app is using cell location by Base Station method. This process might be performed without the user's knowledge."
}, {
    "regex": "telephony\\.TelephonyManager ",
    "forward_check": "getDeviceId",
    "criticity": "warning",
    "label": "Get Device ID",
    "description": "The application is recording the device ID (IMEI). This process might be performed without the user's knowledge."
}, {
    "regex": "telephony\\.TelephonyManager",
    "forward_check": "getSimSerialNumber",
    "criticity": "warning",
    "label": "Get SIM Serial",
    "description": "The application is recording the SIM serial. This process might be performed without the user's knowledge."
}, {
    "regex": "android\\.location ",
    "forward_check": "getLastKnownLocation\\s*\\(|requestLocationUpdates\\s*\\(|getLatitude\\s*\\(|getLongitude\\s*\\(",
    "criticity": "warning",
    "label": "GPS location",
    "description": "This app is using cell location by GPS method. This process might be performed without the user's knowledge."
}, {
    "regex": "android\\.util\\.Base64",
    "forward_check": "\\.encode(?:ToString)?",
    "criticity": "high",
    "label": "Base64 Encode",
    "description": "This application is using Base64 encoding. This is not a secure method to encode data."
}, {
    "regex": "android\\.util\\.Base64",
    "forward_check": "\\.decode",
    "criticity": "warning",
    "label": "Base64 decode",
    "description": "This application is using Base64 decoding."
}]
